SQL Query

1. Department wise salary > average salary

    SELECT dept_id, avg(salary) from emp group by dept_id having avg(salary) > 12000;

2. Department Wise Highest Salary -

    SELECT d.dept_name, MAX(e.salary) FROM department d JOIN employee e ON d.id = e.dept_id GROUP BY d.dept_name;

3. 2nd highest salary employees in each department

    SELECT t.deptno, max(t.salary) FROM emp t WHERE t.salary < (SELECT max(salary) FROM emp t2 WHERE t2.deptno = t.deptno) GROUP BY t.deptno;

4. Department wise duplicate name -

    SELECT a.dept_id, a.name from user a, user b where a.name = b.name and a.id < b.id;

5. Retrieve duplicate records based on multiple column

    SELECT EmpID, EmpFname, Department, COUNT(*) FROM EmployeeInfo GROUP BY EmpID, EmpFname, Department HAVING COUNT(*) > 1;

6. Delete duplicates

    DELETE t1 FROM contacts t1  INNER JOIN contacts t2 WHERE t1.id < t2.id AND t1.email = t2.email;

7. Create a table only structure

    CREATE TABLE NewTable AS SELECT * FROM EmployeeInfo;    SELECT * INTO NewTable FROM EmployeeInfo WHERE 1 = 0;

8. Write a query to fetch all employees who also hold the managerial position.

    SELECT DISTINCT manager.* FROM Employee AS manager JOIN Employee AS employee ON manager.id = employee.manager_id;

9. Find employees with salary less than Dept average

    SELECT name, department_id, salary FROM employees e WHERE salary < (select avg(salary) from employees e2 where e2.department_id = e.department_id);
